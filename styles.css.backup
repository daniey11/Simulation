/* MedSim Pro — PGY2 Critical Care · Branching Simulation */

:root {
  --bg:          #070d18;
  --bg-2:        #0c1829;
  --bg-3:        #101f35;
  --bg-4:        #142540;
  --bg-5:        #1a2e4e;

  --line:        rgba(255,255,255,0.07);
  --line-mid:    rgba(255,255,255,0.13);
  --line-hi:     rgba(255,255,255,0.25);

  --tx-1:        #deeaf8;
  --tx-2:        #7fa0be;
  --tx-3:        #3e5a74;
  --tx-mono:     #6dc4e0;

  --amber:       #e9a535;
  --amber-bg:    rgba(233,165,53,0.12);
  --amber-line:  rgba(233,165,53,0.28);

  --red:         #e04f4f;
  --red-bg:      rgba(224,79,79,0.12);
  --red-line:    rgba(224,79,79,0.28);

  --green:       #42c27a;
  --green-bg:    rgba(66,194,122,0.10);
  --green-line:  rgba(66,194,122,0.28);

  --blue:        #3f9de0;
  --blue-bg:     rgba(63,157,224,0.10);
  --blue-line:   rgba(63,157,224,0.28);

  --cyan:        #6dc4e0;
  --cyan-bg:     rgba(109,196,224,0.10);
  --cyan-line:   rgba(109,196,224,0.25);

  --purple:      #9d7ef5;
  --purple-bg:   rgba(157,126,245,0.10);

  --font-h:  'Rajdhani', sans-serif;
  --font-b:  'IBM Plex Sans', sans-serif;
  --font-m:  'IBM Plex Mono', monospace;

  --r-sm: 4px; --r-md: 8px; --r-lg: 14px; --r-xl: 22px;
  --shadow: 0 12px 40px rgba(0,0,0,0.55);
  --t: 0.18s cubic-bezier(.4,0,.2,1);
  --ts: 0.38s cubic-bezier(.4,0,.2,1);
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { -webkit-font-smoothing: antialiased; }
body {
  font-family: var(--font-b);
  background: var(--bg);
  color: var(--tx-1);
  min-height: 100vh;
  font-size: 15px;
  line-height: 1.6;
  overflow-x: hidden;
}

/* subtle ambient */
body::before {
  content: '';
  position: fixed; inset: 0; z-index: 0; pointer-events: none;
  background:
    radial-gradient(ellipse 70% 50% at 15% 5%, rgba(63,157,224,0.07) 0%, transparent 55%),
    radial-gradient(ellipse 50% 40% at 85% 95%, rgba(233,165,53,0.05) 0%, transparent 55%);
}
body::after {
  content: ''; position: fixed; inset: 0; z-index: 1; pointer-events: none;
  background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0,0,0,0.022) 2px, rgba(0,0,0,0.022) 4px);
}

/* ── HEADER ── */
.site-header {
  position: sticky; top: 0; z-index: 200;
  background: rgba(7,13,24,0.94); backdrop-filter: blur(16px);
  border-bottom: 1px solid var(--line);
}
.header-inner {
  max-width: 1280px; margin: 0 auto; padding: 0 32px;
  height: 60px; display: flex; align-items: center; justify-content: space-between;
}
.logo-block { display: flex; align-items: center; gap: 10px; }
.logo-icon { width: 26px; height: 26px; color: var(--red); flex-shrink: 0; }
.logo-main { font-family: var(--font-h); font-size: 17px; font-weight: 700; letter-spacing: .08em; }
.logo-text { display: flex; flex-direction: column; }
.header-status { display: flex; align-items: center; gap: 7px; }
.status-dot {
  width: 6px; height: 6px; border-radius: 50%;
  background: var(--green); box-shadow: 0 0 7px var(--green);
  animation: blink 2s ease-in-out infinite;
}
@keyframes blink { 0%,100% { opacity:1; } 50% { opacity:.45; } }
.status-text { font-family: var(--font-m); font-size: 10px; letter-spacing: .14em; color: var(--green); }

/* ── APP / SCREENS ── */
#app { position: relative; z-index: 2; min-height: calc(100vh - 60px); }
.screen {
  display: none; opacity: 0; transform: translateY(10px);
  transition: opacity var(--ts), transform var(--ts);
  max-width: 1280px; margin: 0 auto; padding: 44px 32px 80px;
}
.screen.active { display: block; opacity: 1; transform: translateY(0); }

/* ── HOME ── */
.home-hero { margin-bottom: 52px; }
.hero-eyebrow { display: flex; align-items: center; gap: 14px; margin-bottom: 18px; flex-wrap: wrap; }
.eyebrow-tag {
  font-family: var(--font-m); font-size: 9px; letter-spacing: .2em; color: var(--amber);
  background: var(--amber-bg); border: 1px solid var(--amber-line);
  padding: 4px 12px; border-radius: 100px; text-transform: uppercase;
}
.eyebrow-author { font-family: var(--font-m); font-size: 10px; letter-spacing: .07em; color: var(--tx-3); }
.hero-title {
  font-family: var(--font-h); font-size: clamp(46px, 7vw, 86px);
  font-weight: 700; letter-spacing: .04em; line-height: 1.0; margin-bottom: 18px;
}
.hero-desc { font-size: 15px; color: var(--tx-2); max-width: 580px; line-height: 1.75; font-weight: 300; margin-bottom: 24px; }
.objectives-row { display: flex; flex-wrap: wrap; gap: 10px; }
.obj-chip {
  font-family: var(--font-m); font-size: 11px; letter-spacing: .07em;
  color: var(--cyan); background: var(--cyan-bg); border: 1px solid var(--cyan-line);
  padding: 6px 14px; border-radius: 100px;
}

/* MODULE CARDS */
.module-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; }
@media (max-width: 780px) { .module-grid { grid-template-columns: 1fr; } }

.module-card {
  position: relative; border-radius: var(--r-xl); overflow: hidden;
  border: 1px solid var(--line); min-height: 380px; display: flex; flex-direction: column;
  transition: transform var(--t), border-color var(--t), box-shadow var(--t); outline: none;
}
.module-card--active { cursor: pointer; }
.module-card--active:hover, .module-card--active:focus {
  transform: translateY(-4px); border-color: var(--line-mid); box-shadow: var(--shadow);
}
.module-card--locked { cursor: default; opacity: .48; }

.module-bg { position: absolute; inset: 0; z-index: 0; transition: transform var(--ts); }
.module-card--active:hover .module-bg { transform: scale(1.04); }
.critical-bg { background: radial-gradient(ellipse 80% 70% at 110% 20%, rgba(233,165,53,0.2) 0%, transparent 60%), linear-gradient(140deg,#0c1829 0%,#14120a 100%); }
.sepsis-bg   { background: radial-gradient(ellipse 80% 70% at 110% 20%, rgba(224,79,79,0.15) 0%, transparent 60%),  linear-gradient(140deg,#0c1829 0%,#150b0b 100%); }

.lock-overlay {
  position: absolute; inset: 0; z-index: 10;
  display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 6px;
  background: rgba(7,13,24,0.7); backdrop-filter: blur(4px); color: var(--tx-3);
}
.lock-label { font-family: var(--font-h); font-size: 19px; font-weight: 700; letter-spacing: .06em; color: var(--tx-2); }
.lock-sub   { font-family: var(--font-m); font-size: 10px; letter-spacing: .12em; }

.module-content { position: relative; z-index: 1; padding: 36px; flex: 1; display: flex; flex-direction: column; }
.module-content--dim { opacity: .35; }
.module-icon-wrap { width: 48px; height: 48px; color: var(--amber); margin-bottom: 22px; }
.module-tag-text { font-family: var(--font-m); font-size: 9px; letter-spacing: .2em; color: var(--tx-3); text-transform: uppercase; margin-bottom: 8px; }
.module-title { font-family: var(--font-h); font-size: 34px; font-weight: 700; letter-spacing: .04em; line-height: 1.05; margin-bottom: 12px; }
.module-desc-text { font-size: 13px; color: var(--tx-2); font-weight: 300; line-height: 1.7; flex: 1; margin-bottom: 18px; }
.module-meta-row { display: flex; align-items: center; gap: 8px; font-family: var(--font-m); font-size: 10px; letter-spacing: .12em; color: var(--tx-3); margin-bottom: 22px; }
.dot { opacity: .4; }
.module-launch {
  display: inline-flex; align-items: center; gap: 10px; align-self: flex-start;
  font-family: var(--font-h); font-size: 14px; font-weight: 600; letter-spacing: .08em;
  color: var(--amber); background: var(--amber-bg); border: 1px solid var(--amber-line);
  padding: 9px 18px; border-radius: var(--r-sm); transition: gap var(--t);
}
.module-card--active:hover .module-launch { gap: 16px; }

/* ── SCREEN NAV ── */
.screen-nav { display: flex; align-items: center; gap: 18px; margin-bottom: 40px; flex-wrap: wrap; }
.back-btn {
  font-family: var(--font-m); font-size: 11px; letter-spacing: .1em;
  color: var(--tx-2); background: none; border: 1px solid var(--line); border-radius: var(--r-sm);
  padding: 7px 14px; cursor: pointer; transition: all var(--t);
}
.back-btn:hover { color: var(--tx-1); border-color: var(--line-mid); background: var(--bg-4); }
.breadcrumb { display: flex; align-items: center; gap: 7px; font-family: var(--font-m); font-size: 11px; letter-spacing: .08em; color: var(--tx-3); }
.bc-sep { opacity: .35; }
.breadcrumb > *:last-child { color: var(--tx-2); }

/* PHASE TRACK */
.phase-track { display: flex; align-items: center; gap: 0; margin-left: auto; }
.ph-dot {
  width: 28px; height: 28px; border-radius: 50%;
  border: 1px solid var(--line-mid); display: flex; align-items: center; justify-content: center;
  font-family: var(--font-m); font-size: 10px; color: var(--tx-3); transition: all var(--t); flex-shrink: 0;
}
.ph-dot.active  { border-color: var(--cyan); color: var(--cyan); background: var(--cyan-bg); box-shadow: 0 0 10px rgba(109,196,224,0.3); }
.ph-dot.done    { border-color: var(--green); color: var(--green); background: var(--green-bg); }
.ph-line { width: 18px; height: 1px; background: var(--line); }

/* ── CASE SELECTION ── */
.cases-header { margin-bottom: 32px; }
.cases-eyebrow { font-family: var(--font-m); font-size: 9px; letter-spacing: .2em; color: var(--cyan); text-transform: uppercase; margin-bottom: 8px; }
.cases-title { font-family: var(--font-h); font-size: clamp(26px,4vw,46px); font-weight: 700; letter-spacing: .04em; margin-bottom: 8px; }
.cases-sub { font-size: 14px; color: var(--tx-2); font-weight: 300; line-height: 1.65; max-width: 600px; }

.cases-grid { display: grid; grid-template-columns: repeat(3,1fr); gap: 20px; }
@media (max-width: 860px) { .cases-grid { grid-template-columns: 1fr 1fr; } }
@media (max-width: 560px) { .cases-grid { grid-template-columns: 1fr; } }

.case-card {
  background: var(--bg-2); border: 1px solid var(--line); border-radius: var(--r-lg);
  overflow: hidden; cursor: pointer;
  transition: transform var(--t), border-color var(--t), box-shadow var(--t);
  display: flex; flex-direction: column;
}
.case-card:hover { transform: translateY(-4px); border-color: var(--line-mid); box-shadow: var(--shadow); }
.case-card-art { height: 150px; display: flex; align-items: center; justify-content: center; }
.case-card-art svg { width: 68px; height: 68px; }
.case-card-body { padding: 20px; flex: 1; display: flex; flex-direction: column; }
.case-num { font-family: var(--font-m); font-size: 9px; letter-spacing: .18em; color: var(--tx-3); margin-bottom: 6px; }
.case-title-text { font-family: var(--font-h); font-size: 20px; font-weight: 700; letter-spacing: .04em; line-height: 1.15; margin-bottom: 8px; }
.case-blurb { font-size: 12px; color: var(--tx-2); font-weight: 300; line-height: 1.6; flex: 1; margin-bottom: 14px; }
.case-tag {
  display: inline-flex; align-items: center;
  font-family: var(--font-m); font-size: 9px; letter-spacing: .12em; text-transform: uppercase;
  padding: 3px 9px; border-radius: 100px; align-self: flex-start;
  color: var(--red); background: var(--red-bg); border: 1px solid var(--red-line);
}

/* ── SIM CONTENT ── */
#sim-content { display: flex; flex-direction: column; gap: 20px; }

/* PATIENT STRIP */
.pt-strip {
  background: var(--bg-2); border: 1px solid var(--line); border-radius: var(--r-lg);
  padding: 16px 24px; display: flex; align-items: center; gap: 20px; flex-wrap: wrap;
}
.pt-avatar {
  width: 40px; height: 40px; border-radius: 50%; flex-shrink: 0;
  background: var(--bg-4); border: 1px solid var(--line-mid);
  display: flex; align-items: center; justify-content: center;
  font-family: var(--font-h); font-size: 15px; font-weight: 700; color: var(--tx-2);
}
.pt-name { font-family: var(--font-h); font-size: 17px; font-weight: 700; letter-spacing: .04em; line-height: 1.2; }
.pt-meta { font-family: var(--font-m); font-size: 9px; letter-spacing: .1em; color: var(--tx-3); text-transform: uppercase; }
.pt-chips { display: flex; gap: 14px; margin-left: auto; flex-wrap: wrap; }
.pt-chip-label { font-family: var(--font-m); font-size: 8px; letter-spacing: .14em; color: var(--tx-3); text-transform: uppercase; }
.pt-chip-val   { font-family: var(--font-m); font-size: 12px; color: var(--tx-mono); }

/* SIM CARD */
.sim-card {
  background: var(--bg-2); border: 1px solid var(--line);
  border-radius: var(--r-lg); overflow: hidden;
  animation: slideUp .3s ease both;
}
@keyframes slideUp { from { opacity:0; transform:translateY(14px); } to { opacity:1; transform:translateY(0); } }
.sim-card-head {
  padding: 13px 24px; border-bottom: 1px solid var(--line);
  display: flex; align-items: center; gap: 12px;
  background: rgba(255,255,255,0.018);
}
.phase-badge {
  font-family: var(--font-m); font-size: 9px; letter-spacing: .17em;
  text-transform: uppercase; padding: 3px 9px; border-radius: 100px;
}
.pb-vignette { color: var(--cyan);   background: var(--cyan-bg);   border: 1px solid var(--cyan-line); }
.pb-rn       { color: var(--amber);  background: var(--amber-bg);  border: 1px solid var(--amber-line); }
.pb-action   { color: var(--blue);   background: var(--blue-bg);   border: 1px solid var(--blue-line); }
.pb-alert    { color: var(--red);    background: var(--red-bg);    border: 1px solid var(--red-line); }
.pb-branch   { color: var(--purple); background: var(--purple-bg); border: 1px solid rgba(157,126,245,0.28); }
.pb-end      { color: var(--green);  background: var(--green-bg);  border: 1px solid var(--green-line); }

.sim-card-title { font-family: var(--font-h); font-size: 16px; font-weight: 600; letter-spacing: .05em; }
.sim-card-body  { padding: 24px; }

/* VIGNETTE */
.vignette { font-size: 14px; color: var(--tx-2); font-weight: 300; line-height: 1.85; }
.vignette p { margin-bottom: 14px; }
.vignette p:last-child { margin-bottom: 0; }
.hl { font-family: var(--font-m); font-size: 12px; color: var(--tx-mono); background: var(--bg-4); border: 1px solid var(--line-mid); border-radius: 3px; padding: 1px 6px; white-space: nowrap; }

/* RN REPORT */
.rn-box {
  background: var(--amber-bg); border-left: 3px solid var(--amber);
  border-radius: 0 var(--r-md) var(--r-md) 0; padding: 18px 22px; margin-bottom: 18px;
}
.rn-quote { font-size: 14px; color: var(--tx-2); font-weight: 300; line-height: 1.8; font-style: italic; }
.rn-cues { margin-top: 14px; display: flex; flex-direction: column; gap: 7px; }
.rn-cue { font-family: var(--font-m); font-size: 11px; color: var(--amber); letter-spacing: .05em; padding-left: 14px; position: relative; }
.rn-cue::before { content: '▸'; position: absolute; left: 0; }

/* VITALS TABLE */
.vitals-tbl { width: 100%; border-collapse: collapse; }
.vitals-tbl th { font-family: var(--font-m); font-size: 8px; letter-spacing: .16em; color: var(--tx-3); text-transform: uppercase; padding: 9px 12px; border-bottom: 1px solid var(--line); text-align: left; background: rgba(0,0,0,0.18); }
.vitals-tbl td { padding: 11px 12px; border-bottom: 1px solid rgba(255,255,255,0.035); font-family: var(--font-m); }
.vitals-tbl td:first-child { font-size: 10px; letter-spacing: .1em; color: var(--tx-3); text-transform: uppercase; width: 130px; }
.vitals-tbl td:nth-child(2) { font-size: 19px; font-weight: 500; }
.vitals-tbl td:last-child  { font-size: 10px; color: var(--tx-3); }
.vitals-tbl tr:last-child td { border-bottom: none; }
.vn  { color: var(--green); }
.vw  { color: var(--amber); }
.vc  { color: var(--red); }

/* LABS */
.lab-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(155px,1fr)); gap: 1px; background: var(--line); border-radius: var(--r-sm); overflow: hidden; }
.lab-cell { background: var(--bg); padding: 9px 12px; }
.lab-lbl { font-family: var(--font-m); font-size: 8px; letter-spacing: .14em; color: var(--tx-3); text-transform: uppercase; margin-bottom: 3px; }
.lab-val { font-family: var(--font-m); font-size: 14px; font-weight: 500; }
.lv-n { color: var(--tx-1); }
.lv-a { color: var(--amber); }
.lv-c { color: var(--red); }

/* EXAM SYSTEM BUTTONS */
.exam-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(110px,1fr)); gap: 9px; }
.exam-btn {
  background: var(--bg-4); border: 1px solid var(--line-mid);
  border-radius: var(--r-md); padding: 14px 10px; cursor: pointer;
  display: flex; flex-direction: column; align-items: center; gap: 7px; text-align: center;
  transition: all var(--t); outline: none;
}
.exam-btn:hover { border-color: var(--cyan); background: var(--cyan-bg); transform: translateY(-2px); }
.exam-btn.revealed { border-color: var(--green); background: var(--green-bg); }
.exam-btn.revealed .eb-hint { color: var(--green); }
.eb-icon  { font-size: 22px; line-height: 1; }
.eb-label { font-family: var(--font-h); font-size: 13px; font-weight: 600; letter-spacing: .06em; color: var(--tx-2); }
.eb-hint  { font-family: var(--font-m); font-size: 9px; letter-spacing: .09em; color: var(--tx-3); }

.exam-reveals { display: flex; flex-direction: column; gap: 7px; margin-top: 12px; }
.reveal-card {
  display: flex; gap: 10px; align-items: flex-start;
  background: var(--bg-3); border: 1px solid var(--green-line);
  border-radius: var(--r-sm); padding: 11px 14px;
  animation: slideUp .22s ease both;
}
.reveal-sys { font-family: var(--font-m); font-size: 9px; letter-spacing: .14em; color: var(--green); text-transform: uppercase; flex: 0 0 80px; padding-top: 2px; }
.reveal-txt { font-size: 13px; color: var(--tx-2); font-weight: 300; line-height: 1.6; }

/* POCUS */
.pocus-wrap { background: var(--bg); border: 1px solid var(--line-mid); border-radius: var(--r-md); overflow: hidden; }
.pocus-head { padding: 10px 16px; border-bottom: 1px solid var(--line); background: rgba(0,0,0,0.25); }
.pocus-lbl  { font-family: var(--font-m); font-size: 9px; letter-spacing: .18em; color: var(--blue); text-transform: uppercase; }
.pocus-body { padding: 16px; }
.pocus-rows { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 14px; }
@media (max-width: 560px) { .pocus-rows { grid-template-columns: 1fr; } }
.pocus-row  { display: flex; gap: 10px; align-items: flex-start; }
.pocus-k    { font-family: var(--font-m); font-size: 9px; letter-spacing: .1em; color: var(--tx-3); text-transform: uppercase; flex: 0 0 54px; padding-top: 2px; }
.pocus-v    { font-size: 13px; color: var(--tx-2); font-weight: 300; line-height: 1.5; }
.pocus-interp { background: var(--blue-bg); border: 1px solid var(--blue-line); border-radius: var(--r-sm); padding: 12px 16px; }
.pocus-interp-lbl { font-family: var(--font-m); font-size: 8px; letter-spacing: .16em; color: var(--blue); text-transform: uppercase; margin-bottom: 5px; }
.pocus-interp-txt { font-size: 13px; color: var(--tx-2); line-height: 1.6; font-weight: 300; }

/* SECTION LABEL */
.sec-lbl { font-family: var(--font-m); font-size: 9px; letter-spacing: .18em; color: var(--tx-3); text-transform: uppercase; margin-bottom: 9px; padding-bottom: 5px; border-bottom: 1px solid var(--line); }

/* ── ORDER PANEL ── */
.order-panel { display: flex; flex-direction: column; gap: 12px; }
.order-input-wrap { position: relative; }
.orders-ta {
  width: 100%; background: var(--bg); border: 1px solid var(--line); border-radius: var(--r-md);
  color: var(--tx-1); font-family: var(--font-m); font-size: 12.5px; line-height: 1.75;
  padding: 14px 16px; resize: vertical; min-height: 140px; outline: none;
  transition: border-color var(--t), box-shadow var(--t);
}
.orders-ta::placeholder { color: var(--tx-3); font-size: 11px; }
.orders-ta:focus { border-color: var(--cyan); box-shadow: 0 0 0 2px rgba(109,196,224,0.1); }

/* LIVE PARSE PREVIEW */
.order-parse-preview {
  background: var(--bg-3); border: 1px solid var(--line); border-radius: var(--r-md);
  overflow: hidden; min-height: 0; transition: all var(--t);
}
.opp-header {
  padding: 8px 14px; border-bottom: 1px solid var(--line);
  display: flex; align-items: center; justify-content: space-between;
}
.opp-title { font-family: var(--font-m); font-size: 9px; letter-spacing: .18em; color: var(--tx-3); text-transform: uppercase; }
.opp-count { font-family: var(--font-m); font-size: 10px; color: var(--cyan); }
.opp-lines { padding: 8px 10px; display: flex; flex-direction: column; gap: 4px; max-height: 200px; overflow-y: auto; }
.opp-empty { padding: 12px 14px; font-family: var(--font-m); font-size: 10px; color: var(--tx-3); font-style: italic; }

.opp-line {
  display: flex; align-items: flex-start; gap: 8px; padding: 5px 8px;
  border-radius: 4px; background: rgba(255,255,255,0.03);
  animation: slideUp .15s ease both;
}
.opp-cat {
  font-family: var(--font-m); font-size: 8px; letter-spacing: .14em; text-transform: uppercase;
  padding: 2px 7px; border-radius: 100px; flex-shrink: 0; margin-top: 1px; white-space: nowrap;
}
.cat-lab     { color: var(--cyan);   background: var(--cyan-bg);   border: 1px solid var(--cyan-line); }
.cat-imaging { color: var(--blue);   background: var(--blue-bg);   border: 1px solid var(--blue-line); }
.cat-ekg     { color: var(--green);  background: var(--green-bg);  border: 1px solid var(--green-line); }
.cat-med     { color: var(--amber);  background: var(--amber-bg);  border: 1px solid var(--amber-line); }
.cat-fluid   { color: var(--purple); background: var(--purple-bg); border: 1px solid rgba(157,126,245,.28); }
.cat-other   { color: var(--tx-3);   background: rgba(255,255,255,.04); border: 1px solid var(--line); }
.opp-text { font-family: var(--font-m); font-size: 11px; color: var(--tx-2); line-height: 1.4; }

/* RESULT FEED */
.result-feed { display: flex; flex-direction: column; gap: 8px; }
.result-feed-header {
  display: flex; align-items: center; gap: 10px;
  font-family: var(--font-m); font-size: 9px; letter-spacing: .18em; color: var(--tx-3); text-transform: uppercase;
  padding-bottom: 6px; border-bottom: 1px solid var(--line);
}
.result-feed-header::before {
  content: ''; display: block; width: 6px; height: 6px; border-radius: 50%;
  background: var(--green); box-shadow: 0 0 6px var(--green); animation: blink 1.5s infinite;
}
.result-card {
  display: flex; align-items: flex-start; gap: 0;
  background: var(--bg-2); border: 1px solid var(--line); border-radius: var(--r-md);
  overflow: hidden; animation: slideUp .3s ease both;
}
.result-card-type {
  width: 5px; flex-shrink: 0; align-self: stretch;
}
.rct-lab     { background: var(--cyan); }
.rct-imaging { background: var(--blue); }
.rct-ekg     { background: var(--green); }
.rct-fluid   { background: var(--purple); }
.rct-med     { background: var(--amber); }
.result-card-inner { padding: 12px 16px; flex: 1; }
.result-card-tag {
  font-family: var(--font-m); font-size: 8px; letter-spacing: .16em; text-transform: uppercase; margin-bottom: 5px;
}
.result-card-name { font-family: var(--font-h); font-size: 15px; font-weight: 600; letter-spacing: .04em; margin-bottom: 6px; }
.result-card-rows { display: flex; flex-wrap: wrap; gap: 2px 0; }
.rcr-row {
  display: flex; align-items: baseline; gap: 10px; width: 100%;
  padding: 4px 0; border-bottom: 1px solid rgba(255,255,255,.04);
}
.rcr-row:last-child { border-bottom: none; padding-bottom: 0; }
.rcr-label { font-family: var(--font-m); font-size: 9px; letter-spacing: .1em; color: var(--tx-3); text-transform: uppercase; flex: 0 0 110px; }
.rcr-val   { font-family: var(--font-m); font-size: 15px; font-weight: 500; }
.rcr-unit  { font-family: var(--font-m); font-size: 9px; color: var(--tx-3); margin-left: 4px; }
.rcr-ref   { font-family: var(--font-m); font-size: 9px; color: var(--tx-3); margin-left: auto; }
.rv-n  { color: var(--tx-1); }
.rv-a  { color: var(--amber); }
.rv-c  { color: var(--red); }
.rv-ok { color: var(--green); }
.result-card-note { font-size: 12px; color: var(--tx-2); font-weight: 300; line-height: 1.65; margin-top: 8px; font-style: italic; }

/* PROCESSING PULSE */
.processing-row {
  display: flex; align-items: center; gap: 10px; padding: 10px 14px;
  background: var(--bg-3); border: 1px solid var(--line); border-radius: var(--r-sm);
  font-family: var(--font-m); font-size: 11px; color: var(--tx-3);
  animation: slideUp .2s ease both;
}
.proc-dot {
  width: 6px; height: 6px; border-radius: 50%; background: var(--amber);
  animation: blink .8s ease-in-out infinite;
}
.orders-hint { margin-top: 4px; font-family: var(--font-m); font-size: 10px; color: var(--tx-3); letter-spacing: .05em; line-height: 1.55; }

/* CONDITION ALERT */
.cond-alert {
  background: var(--red-bg); border: 1px solid var(--red-line); border-left: 4px solid var(--red);
  border-radius: var(--r-md); padding: 14px 18px; display: flex; align-items: flex-start; gap: 12px;
}
.cond-icon  { font-size: 20px; flex-shrink: 0; line-height: 1.2; }
.cond-title { font-family: var(--font-h); font-size: 15px; font-weight: 600; color: var(--red); letter-spacing: .04em; }
.cond-sub   { font-size: 13px; color: var(--tx-2); font-weight: 300; margin-top: 3px; line-height: 1.55; }

/* BRANCH OUTCOME DISPLAY (inline, after orders submit) */
.branch-outcome {
  border-radius: var(--r-md); padding: 16px 20px;
  animation: slideUp .28s ease both;
}
.branch-outcome.good    { background: var(--green-bg); border: 1px solid var(--green-line); }
.branch-outcome.warning { background: var(--amber-bg); border: 1px solid var(--amber-line); }
.branch-outcome.bad     { background: var(--red-bg);   border: 1px solid var(--red-line); }
.branch-outcome.neutral { background: var(--bg-3);      border: 1px solid var(--line-mid); }
.bo-label { font-family: var(--font-m); font-size: 9px; letter-spacing: .17em; text-transform: uppercase; margin-bottom: 7px; }
.branch-outcome.good .bo-label    { color: var(--green); }
.branch-outcome.warning .bo-label { color: var(--amber); }
.branch-outcome.bad .bo-label     { color: var(--red); }
.branch-outcome.neutral .bo-label { color: var(--tx-3); }
.bo-text { font-size: 14px; color: var(--tx-2); font-weight: 300; line-height: 1.7; }

/* END / COMPLETE */
.end-box { text-align: center; padding: 56px 36px; }
.end-icon { width: 72px; height: 72px; margin: 0 auto 22px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 32px; }
.end-icon.success { background: var(--green-bg); border: 1px solid var(--green-line); }
.end-icon.concern { background: var(--amber-bg); border: 1px solid var(--amber-line); }
.end-title { font-family: var(--font-h); font-size: 34px; font-weight: 700; letter-spacing: .04em; margin-bottom: 10px; }
.end-text  { font-size: 14px; color: var(--tx-2); font-weight: 300; max-width: 460px; margin: 0 auto 28px; line-height: 1.75; }
.summary-box { background: var(--bg-3); border: 1px solid var(--line-mid); border-radius: var(--r-md); padding: 16px 20px; max-width: 560px; margin: 0 auto 24px; text-align: left; }
.summary-lbl  { font-family: var(--font-m); font-size: 9px; letter-spacing: .17em; color: var(--tx-3); text-transform: uppercase; margin-bottom: 10px; }
.summary-item { font-size: 13px; color: var(--tx-2); font-weight: 300; line-height: 1.65; padding: 5px 0 5px 14px; border-bottom: 1px solid rgba(255,255,255,.04); position: relative; }
.summary-item::before { content:'·'; position:absolute; left:4px; color: var(--cyan); }
.summary-item:last-child { border-bottom: none; padding-bottom: 0; }

/* LAYOUT */
.two-col { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
@media (max-width: 700px) { .two-col { grid-template-columns: 1fr; } }
.mt-16 { margin-top: 16px; }
.mt-20 { margin-top: 20px; }
.mt-24 { margin-top: 24px; }

/* BUTTONS */
.btn {
  display: inline-flex; align-items: center; gap: 7px;
  font-family: var(--font-h); font-size: 14px; font-weight: 600; letter-spacing: .08em;
  padding: 10px 22px; border-radius: var(--r-sm); border: 1px solid transparent;
  cursor: pointer; transition: all var(--t); outline: none; white-space: nowrap;
}
.btn--primary  { background: var(--cyan);    color: var(--bg);    border-color: var(--cyan); }
.btn--primary:hover  { background: #9adcef; transform: translateY(-1px); box-shadow: 0 5px 18px rgba(109,196,224,0.32); }
.btn--secondary { background: transparent; color: var(--tx-2); border-color: var(--line-mid); }
.btn--secondary:hover { background: var(--bg-4); color: var(--tx-1); border-color: var(--line-hi); }
.btn--amber { color: var(--amber); background: var(--amber-bg); border-color: var(--amber-line); }
.btn--amber:hover { background: rgba(233,165,53,.22); transform: translateY(-1px); }
.btn--full { width: 100%; justify-content: center; }
.btn-row { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 18px; }

/* MODALS */
.modal-overlay {
  position: fixed; inset: 0; z-index: 1000;
  background: rgba(4,9,18,0.86); backdrop-filter: blur(14px);
  display: flex; align-items: center; justify-content: center; padding: 20px;
  animation: fadeIn .18s ease;
}
.modal-overlay[hidden] { display: none; }
@keyframes fadeIn { from { opacity:0; } to { opacity:1; } }
.modal-box {
  background: var(--bg-2); border: 1px solid var(--line-mid); border-radius: var(--r-xl);
  width: 100%; max-height: 88vh; overflow-y: auto;
  box-shadow: var(--shadow); animation: modalPop .24s cubic-bezier(.34,1.56,.64,1) both;
}
.modal-sm { max-width: 420px; }
@keyframes modalPop { from { opacity:0; transform:scale(.94) translateY(10px); } to { opacity:1; transform:scale(1) translateY(0); } }
.modal-head {
  padding: 20px 24px 16px; border-bottom: 1px solid var(--line);
  display: flex; align-items: flex-start; justify-content: space-between; gap: 14px;
  position: sticky; top: 0; background: var(--bg-2); z-index: 1;
}
.modal-tag   { font-family: var(--font-m); font-size: 9px; letter-spacing: .2em; color: var(--cyan); text-transform: uppercase; display: block; margin-bottom: 5px; }
.modal-title { font-family: var(--font-h); font-size: 20px; font-weight: 700; letter-spacing: .04em; }
.modal-x     { width: 30px; height: 30px; border-radius: var(--r-sm); border: 1px solid var(--line); background: transparent; color: var(--tx-3); cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 13px; flex-shrink: 0; transition: all var(--t); }
.modal-x:hover { background: var(--bg-4); color: var(--tx-1); border-color: var(--line-mid); }
.modal-body { padding: 22px 24px; font-size: 14px; color: var(--tx-2); font-weight: 300; line-height: 1.75; }
.modal-foot { padding: 16px 24px 20px; border-top: 1px solid var(--line); display: flex; justify-content: flex-end; }

.rn-from { font-family: var(--font-m); font-size: 9px; letter-spacing: .14em; color: var(--amber); text-transform: uppercase; display: flex; align-items: center; gap: 8px; margin-bottom: 12px; }
.rn-from::before { content:''; display:block; width:7px; height:7px; border-radius:50%; background: var(--amber); box-shadow:0 0 7px var(--amber); animation: blink 1.4s infinite; flex-shrink:0; }

@media (max-width: 600px) {
  .screen { padding: 24px 16px 60px; }
  .header-inner { padding: 0 16px; }
  .phase-track { display: none; }
  .pt-chips { display: none; }
}

/* ── ADDITIONAL ORDER PANEL STATES ── */
.orders-ta:disabled {
  opacity: 0.55;
  cursor: not-allowed;
  border-color: var(--line);
}
.btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none !important;
  box-shadow: none !important;
}
#result-feed-wrap {
  animation: slideUp .3s ease both;
}
